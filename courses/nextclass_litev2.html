<head>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
	<script src="https://code.jquery.com/jquery-3.6.1.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<meta charset="UTF-8">
	<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
	<script src="gzip.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/pako/2.0.4/pako.min.js" integrity="sha512-EAKzSKex+PXC0U9OG13r1059ysjrjkJEpZoONCnZa0mBROY28iBOOxZSErUVw1LzLr2+U5PhR7zPCPKidUVJqg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<script src="https://cdn.jsdelivr.net/npm/darkreader@4.9.58/darkreader.min.js"></script>
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/pulltorefreshjs/0.1.22/index.umd.min.js" integrity="sha512-djmgTiVR15A/7fON+ojDzFYrRsfVkzQZu07ZVb0zLC1OhA2iISP39Lzs05GqSKF0vPjkLzL5hBC+am6po7dKpA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<style>
		.card-header {
		    background-color: rgb(0, 61, 165);
		    color: white;
		}
		.progress-bar {
		    background-color: rgb(0, 61, 165);
		}
		.row-pad {
		    padding-bottom: 25px;
		}
		.parent { display: -ms-flex; display: -webkit-flex; display: flex; }
		.parent>div { flex:1; }
		
		.row {
		    margin-right: unset !important;
		    margin-left: unset !important;
		}
		
		.container, .container-fluid, .container-lg, .container-md, .container-sm, .container-xl, .container-xxl {
		    padding-right: unset !important;
		    padding-left: unset !important;
		}
		.table>:not(caption)>*>* {
		    padding: 0.5rem 0rem;
		}
		.small, small {
		    font-size: .6em;
		}
		.card-body {
		    padding: 0.5rem 0.5rem;
		    text-align: center;
		}
		
		.card-header {
		    padding: 0.5rem 0.5rem;
		    text-align: center;
		}
		html, body {
		  overscroll-behavior-y: none;
		}
	</style>
</head>
<br/>
<div style="padding: 5px 16px;"><h4>Welcome, Highlander!</h4></div>
<div id="courses" class="container-fluid row">
		<div style="padding: 5px 16px;">üéâHooray! No more class today!</div>
</div>
<br/>
<section>
        <section>
            <div style="padding: 5px;">
                <div class="bg-light border rounded border-0 border-light d-flex justify-content-between flex-lg-row p-3 p-md-4" onclick="mapChoice()">
                    <div class="pb-2 pb-lg-1">
                        <h6 class="fw-bold mb-2">Campus Map</h6>
                        <p class="mb-0"></p>
                    </div>
                    <div class="my-2"><a class="btn btn-primary " role="button" onclick="mapChoice();">></a></div>
                </div>
            </div>
            <div style="padding: 5px;">
                <!--<div class="bg-light border rounded border-0 border-light d-flex justify-content-between flex-lg-row p-3 p-md-4" onclick="parent.profile();">-->
                <div class="bg-light border rounded border-0 border-light d-flex justify-content-between flex-lg-row p-3 p-md-4" onclick="parent.modalFrameGo('/coursedifficulty/index.html','Class Difficulty')">
                    <div class="pb-2 pb-lg-1">
                        <h6 class="fw-bold mb-2">Class Difficulty Database</h6>
                        <p class="mb-0"></p>
                    </div>
                    <div class="my-2"><a class="btn btn-primary " role="button" onclick="parent.profile();">></a></div>
                </div>
            </div>
            <div style="padding: 5px;">
                <div class="bg-light border rounded border-0 border-light d-flex justify-content-between flex-lg-row p-3 p-md-4" onclick="parent.settings();">
                    <div class="pb-2 pb-lg-1">
                        <h6 class="fw-bold mb-2">Parking Spaces Availability</h6>
                        <p class="mb-0"></p>
                    </div>
                    <div class="my-2"><a class="btn btn-primary " role="button" onclick="parent.settings();">></a></div>
                </div>
            </div>
            <div style="padding: 5px;">
                <div class="bg-light border rounded border-0 border-light d-flex justify-content-between flex-lg-row p-3 p-md-4" onclick="parent.food();">
                    <div class="pb-2 pb-lg-1">
                        <h6 class="fw-bold mb-2">Term Schedule</h6>
                        <p class="mb-0"></p>
                    </div>
                    <div class="my-2"><a class="btn btn-primary " role="button" onclick="parent.food();">></a></div>
                </div>
            </div>
            <div style="padding: 5px;">
                <div class="bg-light border rounded border-0 border-light d-flex justify-content-between flex-lg-row p-3 p-md-4" onclick="parent.modalFrameGo('/pwa/links.html','Useful Links')">
                    <div class="pb-2 pb-lg-1">
                        <h6 class="fw-bold mb-2">Useful Links</h6>
                        <p class="mb-0"></p>
                    </div>
                    <div class="my-2"><a class="btn btn-primary " role="button" onclick="parent.modalFrameGo('/pwa/links.html','Useful Links')">></a></div>
                </div>
            </div>
            <div style="padding: 5px;">
                <div class="bg-light border rounded border-0 border-light d-flex justify-content-between flex-lg-row p-3 p-md-4" onclick="parent.modalFrameGo('/dining/glasgow.html','Dining Menus')">
                    <div class="pb-2 pb-lg-1">
                        <h6 class="fw-bold mb-2">Dining Menus</h6>
                        <p class="mb-0"></p>
                    </div>
                    <div class="my-2"><a class="btn btn-primary " role="button" onclick="parent.modalFrameGo('/dining/glasgow.html','Dining Menus')">></a></div>
                </div>
            </div>
            
            <!--<div style="padding: 5px;">
                <div class="bg-light border rounded border-0 border-light d-flex justify-content-between flex-lg-row p-3 p-md-4" onclick="parent.modalFrameGo('/pushnotifications','Push Notifications')">
                    <div class="pb-2 pb-lg-1">
                        <h6 class="fw-bold mb-2">Subscribe to Notifications</h6>
                        <p class="mb-0"></p>
                    </div>
                    <div class="my-2"><a class="btn btn-primary " role="button" onclick="parent.modalFrameGo('/pushnotifications','Push Notifications')">></a></div>
                </div>
            </div>-->
            
            <div style="padding: 5px 16px;">
	            <a type="button" class="btn btn-primary" href="https://discord.gg/4GbyYjVvNX" target="_blank">üí¨ Discord</a>
	            <a type="button" class="btn btn-primary" href="https://forms.fillout.com/t/bwqTgEbZasus" target="_blank">‚ö†Ô∏è Feedbacks</a>
	            <button type="button" class="btn btn-primary" onclick="parent.modalFrameGo('/about.html','About This APP')">‚ÑπÔ∏è About</button>
	        </div>
        </section>
    </section><br/><br/>

	
<script>
	function mapChoice(){
		Swal.fire({
		    title: 'Choose Map',
		    text: "Please choose between Official Map or GoHighlander Map",
		    showCancelButton: true,
		    confirmButtonText: 'GoHighlander Map',
		    cancelButtonText: 'Official Map',
		    reverseButtons: true
		}).then((result) => {
		    if (result.isConfirmed) {
		        myFunctionForConfirm();
		    } else if (
		        /* Read more about handling dismissals below */
		        result.dismiss === Swal.DismissReason.cancel
		    ) {
		        myFunctionForCancel();
		    }
		});
		
		function myFunctionForConfirm() {
		    // Code for the first option
		    parent.map();
		}
		
		function myFunctionForCancel() {
		    // Code for the second option
		    //parent.modalFrameGo('https://campusmap.ucr.edu/','UCR Map');
		    window.open('https://campusmap.ucr.edu/?id=2106#!ct/71247,71304,71305,74437,74491,74497,74498,74499,74500,74501,74502,74503,71297,73811,73814,73859,73873,73874,73875,73876', '_blank');
		}
	}
	var nextClass = [];
	var currTime = new Date();
	var today = currTime.getDay();
	var currentTime = parseInt(''+currTime.getHours()+(currTime.getMinutes()<10?'0':'') + currTime.getMinutes());
/*document.getElementById("m").innerHTML += `
											
							<div class="card">
							      <small class="card-header" style="background:`+color+`">
							         `+courseNumber+`
							      </small>
							      <div class="card-body">
							         <small class="card-text">
							            `+sTime+` - `+eTime+`
							         </small>
							         
							   </div>
							</div>`;
							
						
						var sTime = currCourse['sTime'];
						var eTime = currCourse['eTime'];
						var courseNumber = currCourse['courseNumber'];*/
	
	var mCourses = [];
	var tCourses = [];
	var wCourses = [];
	var thCourses = [];
	var fCourses = [];
	
	function loadSavedCourses(){
		mCourses = [];
		tCourses = [];
		wCourses = [];
		thCourses = [];
		fCourses = [];
			var defaultTerm = '';
			
			if(getCookie("defaultTerm")){
				defaultTerm = getCookie("defaultTerm");
			}
			
			
	        if(getCookie(defaultTerm)){
	        	var courseDatas = JSON.parse(gzipToText(getCookie(defaultTerm)));
	        }
	        
	        if(!courseDatas){
		        document.getElementById("courses").innerHTML = `
											
							<div style="padding: 5px 16px;">No classes added yet, add one in courses!</div>`;
				if(getCookie("termsData")){
			        var termsData = JSON.parse(getCookie("termsData"));
			        if(termsData.length >= 1){
				        setDefaultTerm();
			        }
		        }
		        return;
	        }
	        if(courseDatas.length == 0){
		        document.getElementById("courses").innerHTML = `
											
							<div style="padding: 5px 16px;">No classes added yet, add one in courses!</div>`;
				if(getCookie("termsData")){
			        var termsData = JSON.parse(getCookie("termsData"));
			        if(termsData.length >= 1){
				        setDefaultTerm();
			        }
		        }
		        return;
	        }
			for(var i = 0; i < courseDatas.length;i++){
						var currCourse = courseDatas[i]['course'];
						
						var m = currCourse['m'];
						var t = currCourse['t'];
						var w = currCourse['w'];
						var th = currCourse['th'];
						var f = currCourse['f'];
						
					    
					    if(m){
						    mCourses.push(currCourse);
					    }
					    if(t){
						    tCourses.push(currCourse);
					    }
					    if(w){
						    wCourses.push(currCourse);
					    }
					    if(th){
						    thCourses.push(currCourse);
					    }
					    if(f){
						    fCourses.push(currCourse);
					    }
				}
				/**/
				sort()
				
	}
	loadSavedCourses();
	
	function sort(){
		mCourses.sort((a, b) => a.sTime - b.sTime)
		tCourses.sort((a, b) => a.sTime - b.sTime)
		wCourses.sort((a, b) => a.sTime - b.sTime)
		thCourses.sort((a, b) => a.sTime - b.sTime)
		fCourses.sort((a, b) => a.sTime - b.sTime)
		loadM();
		loadT();
		loadW();
		loadTH();
		loadF();
	}
	
	
	
	function loadM(){
		for(var i = 0; i < mCourses.length;i++){
			var currCourse = mCourses[i];
			var sTime = currCourse['sTime'];
			var eTime = currCourse['eTime'];
			var color = currCourse['color'];
			var building = currCourse['bdst'] + " " +currCourse['room'];
			var courseNumber = currCourse['courseNumber'];
			var nextClassStr = "";
			
			if(today == 1){
				if(parseInt(eTime) > currentTime && nextClass.length == 0){
					nextClass = currCourse;
					/*document.getElementById("courses").innerHTML = `
											
							<div style="padding: 5px 16px;">Next Class: <br/>`+courseNumber+` Mon `+time_convert(sTime)+` - `+time_convert(eTime)+`@`+building+`<br/><br/><button type="button" class="btn btn-primary" onclick="parent.modalFrameGo('/map/location_details_short.html?loc=`+currCourse['bdst']+`','`+currCourse['bdst']+`')">View Location Detail</button>`+`</div>`;*/
					document.getElementById("courses").innerHTML = `
											
							<div style="padding: 5px 16px;">Next Class: <br/>`+courseNumber+` Mon `+time_convert(sTime)+` - `+time_convert(eTime)+`@`+building+`<br/><br/><button type="button" class="btn btn-primary" onclick="parent.mapShowCode('`+currCourse['bdst']+`')">View Location Detail</button>`+`</div>`;
							
				}
			}
			
				
		}
			
	}
	
	function loadT(){
		for(var i = 0; i < tCourses.length;i++){
			var currCourse = tCourses[i];
			var sTime = currCourse['sTime'];
			var eTime = currCourse['eTime'];
			var color = currCourse['color'];
			var courseNumber = currCourse['courseNumber'];
			var building = currCourse['bdst'] + " " +currCourse['room'];
			var nextClassStr = "";
			
			if(today == 2){
				if(parseInt(eTime) > currentTime && nextClass.length == 0){
					nextClass = currCourse;
					nextClassStr = "Next Class<br/>";
					document.getElementById("courses").innerHTML = `
											
							<div style="padding: 5px 16px;">Next Class: <br/>`+courseNumber+` Tues `+time_convert(sTime)+` - `+time_convert(eTime)+`@`+building+`<br/><br/><button type="button" class="btn btn-primary" onclick="parent.mapShowCode('`+currCourse['bdst']+`')">View Location Detail</button>`+`</div>`;
				}
			}
			
				
			
		}
	}
	
	function loadW(){
		for(var i = 0; i < wCourses.length;i++){
			var currCourse = wCourses[i];
			var sTime = currCourse['sTime'];
			var eTime = currCourse['eTime'];
			var color = currCourse['color'];
			var courseNumber = currCourse['courseNumber'];
			var building = currCourse['bdst'] + " " +currCourse['room'];
			var nextClassStr = "";
			
			if(today == 3){
				if(parseInt(eTime) > currentTime && nextClass.length == 0){
					console.log("1")
					nextClass = currCourse;
					nextClassStr = "Next Class<br/>";
					document.getElementById("courses").innerHTML = `
											
							<div style="padding: 5px 16px;">Next Class: <br/>`+courseNumber+` Weds `+time_convert(sTime)+` - `+time_convert(eTime)+`@`+building+`<br/><br/><button type="button" class="btn btn-primary" onclick="parent.mapShowCode('`+currCourse['bdst']+`')">View Location Detail</button>`+`</div>`;
				}
			}
			
				
			
		}
	}
	
	function loadTH(){
		for(var i = 0; i < thCourses.length;i++){
			var currCourse = thCourses[i];
			var sTime = currCourse['sTime'];
			var eTime = currCourse['eTime'];
			var color = currCourse['color'];
			var courseNumber = currCourse['courseNumber'];
			var building = currCourse['bdst'] + " " +currCourse['room'];
			var nextClassStr = "";
			
			if(today == 4){
				if(parseInt(eTime) > currentTime && nextClass.length == 0){
					nextClass = currCourse;
					document.getElementById("courses").innerHTML = `
											
							<div style="padding: 5px 16px;">Next Class: <br/>`+courseNumber+` Thurs `+time_convert(sTime)+` - `+time_convert(eTime)+`@`+building+`<br/><br/><button type="button" class="btn btn-primary" onclick="parent.mapShowCode('`+currCourse['bdst']+`')">View Location Detail</button>`+`</div>`;
				}
			}
			
				
			
		}
	}
	
	function loadF(){
		for(var i = 0; i < fCourses.length;i++){
			var currCourse = fCourses[i];
			var sTime = currCourse['sTime'];
			var eTime = currCourse['eTime'];
			var color = currCourse['color'];
			var courseNumber = currCourse['courseNumber'];
			var building = currCourse['bdst'] + " " +currCourse['room'];
			var nextClassStr = "";
			
			if(today == 5){
				if(parseInt(eTime) > currentTime && nextClass.length == 0){
					nextClass = currCourse;
					document.getElementById("courses").innerHTML = `
											
							<div style="padding: 5px 16px;">Next Class: <br/>`+courseNumber+` Thurs `+time_convert(sTime)+` - `+time_convert(eTime)+`@`+building+`<br/><br/><button type="button" class="btn btn-primary" onclick="parent.mapShowCode('`+currCourse['bdst']+`')">View Location Detail</button>`+`</div>`;
				}
			}
		}
	}
	
	
	
	function removeCourse(courseNumber,secNumber) {
			var courseDatas = JSON.parse(gzipToText(getCookie("courseDatav2")));
			for(var i = 0; i < courseDatas.length;i++){
				cNum = courseDatas[i]['course']['courseNumber'];
				sNum = courseDatas[i]['course']['secNumber'];
				if(courseNumber == cNum && secNumber == sNum){
					courseDatas.splice(i, 1);
				}
			}
			eraseCookie("courseDatav2");
			setCookie("courseDatav2",textToGzip(JSON.stringify(courseDatas)),99);
			/*Swal.fire(
			  'Success',
			  'Course Removed',
			  'success'
			)*/
			location.reload();
	}
	function setCookie(cname, cvalue, exdays) {
	  const d = new Date();
	  d.setTime(d.getTime() + (exdays*24*60*60*1000));
	  let expires = "expires="+ d.toUTCString();
	  document.cookie = cname + "=" + cvalue + ";" + expires + ";path=/";
	}
	
	function getCookie(cname) {
	  let name = cname + "=";
	  let decodedCookie = decodeURIComponent(document.cookie);
	  let ca = decodedCookie.split(';');
	  for(let i = 0; i <ca.length; i++) {
	    let c = ca[i];
	    while (c.charAt(0) == ' ') {
	      c = c.substring(1);
	    }
	    if (c.indexOf(name) == 0) {
	      return c.substring(name.length, c.length);
	    }
	  }
	  return "";
	}
	
	function eraseCookie(name) {   
    	document.cookie = name+'=; Max-Age=-99999999;';  
	}
	function time_convert(num)
	 { 
	  var hours = Math.floor(num / 100);  
	  var suffix = hours >= 12 ? "PM":"AM";
	  hours = ((hours + 11) % 12 + 1)
	  var minutes = Math.floor(num % 100);
	  if(minutes == 0){
		  minutes = "00"
	  }
	  return hours + ":" + minutes + suffix;         
	}
	
	var checkCookie = function() {
	
	    var lastCookie = document.cookie;
	
	    return function() {
	
	        var currentCookie = document.cookie;
	
	        if (currentCookie != lastCookie) {
				loadSavedCourses();
	            lastCookie = currentCookie; 
	
	        }
	    };
	}();
	
	
	function setDefaultTerm(){
		if(getCookie("termsData")){
			const inputOptions = JSON.parse(getCookie("termsData"))
			
			const selectedTerm = Swal.fire({
			  title: 'Select Term',
			  input: 'select',
			  inputLabel: 'You can always change this in course management page.',
			  inputOptions: inputOptions,
			  inputValidator: (value) => {
			    if (!value) {
			      return 'You need to choose something!'
			    }else{
				    var selectedTerm = inputOptions[value];
				    if(getCookie("defaultTerm")){
					    eraseCookie("defaultTerm");
						setCookie("defaultTerm",selectedTerm,999);
				    }else{
					    setCookie("defaultTerm",selectedTerm,999);
				    }
			    }
			  }
			})
		}
	}
	
	window.setInterval(checkCookie, 100);
	//dark reader
	DarkReader.auto({
	    brightness: 100,
	    contrast: 100
	});
	
	const ptr = PullToRefresh.init({
		  mainElement: 'body',
		  onRefresh() {
		    window.location.reload();
		  }
		});
</script>